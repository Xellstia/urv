<%# app/views/template_cards/_card.html.erb %>
<%# Обёртка над shared/card. Принимает: card (предпочтительно) или template_card. %>
<% tc = local_assigns[:card] || local_assigns[:template_card] %>
<% return unless tc %>

<% title_safe = (tc.try(:title).presence || tc.description.to_s) %>

<%= render "shared/card",
      id:       tc,
      state:    nil,
      kind:     :preset,  # Используем preset стиль как в расписании
      title:    title_safe,
      desc:     nil,
      code:     (tc.respond_to?(:issue_key) ? tc.issue_key : nil),
      minutes:  (tc.respond_to?(:minutes_spent) ? tc.minutes_spent : tc.try(:minutes)).to_i,
      delete_button: "template_cards/delete_button",
      delete_button_locals: { card: tc, category: tc.template_category },
      edit_path: (defined?(edit_template_category_template_card_path) ?
                    edit_template_category_template_card_path(tc.template_category, tc, frame_id: "modal") : nil),
      edit_frame: "modal" %>
